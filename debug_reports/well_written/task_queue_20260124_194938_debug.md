# IRIS Debug Report

**File:** `task_queue.js`  
**Language:** `javascript`  
**Execution Path:** ðŸ”§ Tool-Calling with Signature Graph  

---

## Source Code Overview

### Stage 1: Original Source Code

**Total Lines:** 201  
**Size:** 5,137 bytes

```javascript
/**
 * Priority Task Queue
 * 
 * Manages asynchronous tasks with priority levels, concurrency limits,
 * and automatic retry logic for failed tasks.
...(truncated)
```

### Signature Graph Snapshot

**Entities:** 15

```json
{
  "entities": [
    {
      "id": "entity_0",
      "name": "Task",
      "type": "class",
      "signature": "class Task",
      "line_range": [
        14,
        41
      ],
      "depth": 0,
      "scope": "module",
      "parent_id": null,
      "children_ids": [
        "entity_1",
        "entity_2"
      ],
      "calls": [],
      "leading_comment": "/**\n * Priority Task Queue\n * \n * Manages asynchronous tasks with priority levels, concurrency limits,\n * and automatic retry logic for failed tasks.\n */\n// Priority levels for task scheduling",
      "inline_comment": null,
      "trailing_comment": "/**\n   * Create a new task with priority and retry configuration\n   * @param {Function} taskFunction - Async function to execute\n   * @param {number} priority - Priority level (0 = highest)\n   * @param {number} maxRetries - Maximum retry attempts on failure\n   */",
      "docstring": null
    },
    {
      "id": "entity_1",
      "name": "constructor",
  ...(truncated for readability)
```

---

## LLM Processing Metrics

### ðŸ”§ Tool-Calling Execution

Single-stage analysis with dynamic source reading: LLM analyzes shallow AST and calls `refer_to_source_code()` tool when needed.

#### Summary

| Metric | Value |
|--------|-------|
| Total Input Tokens | 2,488 |
| Total Output Tokens | 708 |
| Total Tokens | 3,196 |
| Total Time | 13.32s |
| Stages | 1 |

#### Stage Details

**Tool Calling Analysis**

| Metric | Value |
|--------|-------|
| Input Tokens | 2,488 |
| Output Tokens | 708 |
| Total Tokens | 3,196 |
| Time | 13.32s |

**Throughput:**

- Tokens/Second: 239.9 tok/s
- Input: 2,488 tok | Output: 708 tok | Total: 3,196 tok

<details>
<summary><strong>ðŸ“„ Full LLM Response</strong> (click to expand)</summary>

```json
{
  "file_intent": "Task orchestrator for managing asynchronous operations with priority and retry mechanisms, ensuring efficient task execution and error handling.",
  "initial_hypothesis": "The file defines a priority task queue system with classes for tasks and the queue itself, managing task execution based on priority and concurrency.",
  "entity_count_validation": {
    "total_entities": 13,
    "responsibilities_count": 3,
    "required_range": "3-5",
    "passes_anti_collapse_rule": true
  },
  "verification_processes": [
    {
      "read_entities": [
        {
          "id": "entity_2",
          "name": "_generateTaskId",
          "reason": "Ambiguous name with no comments; needed to understand task ID generation."
        },
        {
          "id": "entity_8",
          "name": "_executeTask",
          "reason": "Ambiguous name with no comments; needed to understand task execution logic."
        }
      ]
    }
  ],
  "responsibilities": [
    {
      "id": "task-creation",
      "label": "Task Creation and Identification",
      "description": "Handles the creation of tasks with unique identifiers and configurations for execution.",
      "elements": {
        "functions": [
          "constructor",
          "_generateTaskId"
        ],
        "state": [],
        "imports": [],
        "types": [],
        "constants": []
      },
      "ranges": [
        [
          14,
          41
        ]
      ]
    },
    {
      "id": "task-queue-management",
      "label": "Task Queue Management",
      "description": "Manages the queue of tasks, including adding new tasks, processing them, and maintaining queue statistics.",
      "elements": {
        "functions": [
          "constructor",
          "enqueue",
          "_sortPendingTasksByPriority",
          "_processNextTask",
          "_executeTask",
          "getQueueStats",
          "getTaskById",
          "clearHistory",
          "waitUntilEmpty"
        ],
        "state": [],
        "imports": [],
        "types": [],
        "constants": []
      },
      "ranges": [
        [
          43,
          191
        ]
      ]
    },
    {
      "id": "task-constants",
      "label": "Task Priority Constants",
      "description": "Defines constants for task priority levels used in task scheduling.",
      "elements": {
        "functions": [],
        "state": [],
        "imports": [],
        "types": [],
        "constants": [
          "PRIORITY_URGENT",
          "PRIORITY_HIGH",
          "PRIORITY_NORMAL",
          "PRIORITY_LOW"
        ]
      },
      "ranges": [
        [
          194,
          201
        ]
      ]
    }
  ],
  "metadata": {
    "logical_depth": "Shallow",
    "notes": "The file is structured around two main classes: Task and PriorityTaskQueue, with clear responsibilities for task creation and queue management."
  }
}
```

</details>

---

## Tool Call Records

**Total Tool Calls:** 2

### Tool Call Summary

| # | Tool | Line Range | Size | Duration | Timestamp |
|---|------|-----------|------|----------|-----------|
| 1 | `refer_to_source_code` | 38-40 | 108B | 0.00s | 19:49:26 |
| 2 | `refer_to_source_code` | 113-137 | 635B | 0.00s | 19:49:26 |

### Tool Call Details

#### Call #1: refer_to_source_code

**Timestamp:** 19:49:26.937  
**Arguments:**

```json
{
  "start_line": 38,
  "end_line": 40
}
```

**Result Size:** 108 bytes

**Source Code Retrieved:**

```javascript
  static _generateTaskId() {
    return `task_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
  }
```

#### Call #2: refer_to_source_code

**Timestamp:** 19:49:26.937  
**Arguments:**

```json
{
  "start_line": 113,
  "end_line": 137
}
```

**Result Size:** 635 bytes

**Source Code Retrieved:**

```javascript
  async _executeTask(task) {
    task.status = 'running';
    task.attempts++;

    try {
      const result = await task.taskFunction();
      task.result = result;
      task.status = 'completed';
      this.completedTasks.push(task);
    } catch (error) {
      task.error = error;
      
      if (task.attempts < task.maxRetries) {
        task.status = 'retrying';
        this.pendingTasks.unshift(task);
        this._sortPendingTasksByPriority();
      } else {
        task.status = 'failed';
        this.failedTasks.push(task);
      }
    } finally {
      this.currentlyRunning--;
      this._processNextTask();
    }
  }
```

---

*Report generated for IRIS AST transformation analysis*